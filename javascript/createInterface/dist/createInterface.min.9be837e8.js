"use strict";var InternationalDropDown=React.createClass({displayName:"InternationalDropDown",getInitialState:function(){return{hasError:!1}},setError:function(status){this.setState({hasError:status})},render:function(){var fgClasses=classNames({"form-group":!0,"has-error":this.state.hasError}),countries=this.props.countries;if(void 0===this.props.formStyle||"vertical"===this.props.formStyle)var output=React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-4 col-md-push-3"},React.createElement("div",{className:fgClasses,id:"country"},React.createElement("label",{htmlFor:"country",className:"control-label"},"Country"),React.createElement("select",{id:"country",name:"country",className:"form-control"},Object.keys(countries).map(function(key){return React.createElement("option",{key:key,value:key},countries[key])})))));if("horizontal"===this.props.formStyle)var output=React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"country",className:"col-lg-3 control-label"},"Country"),React.createElement("div",{className:"col-lg-8"},React.createElement("select",{id:"country",name:"country",className:"form-control"},Object.keys(countries).map(function(key){return React.createElement("option",{key:key,value:key},countries[key])}))));return output}}),StateDropDown=React.createClass({displayName:"StateDropDown",getInitialState:function(){return{hasError:!1}},setError:function(status){this.setState({hasError:status})},render:function(){var fgClasses=classNames({"form-group":!0,"has-error":this.state.hasError}),states=this.props.states;if(void 0===this.props.formStyle||"vertical"===this.props.formStyle)var output=React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-4 col-md-push-3"},React.createElement("div",{className:fgClasses,id:"state"},React.createElement("label",{htmlFor:"state",className:"control-label"},"State"),React.createElement("select",{id:"state",name:"state",className:"form-control"},Object.keys(states).map(function(key){return React.createElement("option",{key:key,value:key},states[key])})))));if("horizontal"===this.props.formStyle)var output=React.createElement("div",{"class":"form-group"},React.createElement("label",{htmlFor:"state",className:"col-lg-3 control-label"},"State"),React.createElement("div",{className:"col-lg-8"},React.createElement("select",{id:"state",name:"state",className:"form-control"},Object.keys(states).map(function(key){return React.createElement("option",{key:key,value:key},states[key])}))));return output}}),ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,StudentSearch=React.createClass({displayName:"StudentSearch",getInitialState:function(){return{student:null,studentFound:!1,hasError:!1}},doSearch:function(searchString){$.ajax({url:"index.php?module=intern&action=GetSearchSuggestions",dataType:"json",data:{searchString:searchString},success:function(data){1==data.length&&void 0===data[0].error&&this.setState({student:data[0],studentFound:!0,hasError:!1})}.bind(this),error:function(xhr,status,err){console.error(status,err.toString())}.bind(this)})},studentFound:function(){return this.state.studentFound},resetPreview:function(){this.setState({student:null,studentFound:!1})},setError:function(status){this.setState({hasError:status})},render:function(){var fgClasses=classNames({"form-group":!0,"has-success":this.state.studentFound||this.state.hasError,"has-feedback":this.state.studentFound,"has-error":this.state.hasError});return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-6 col-md-push-3"},React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-body"},React.createElement("h3",{style:{marginTop:"0"}},React.createElement("i",{className:"fa fa-user"})," Student"),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-10 col-md-push-1"},React.createElement("div",{className:fgClasses,id:"studentId"},React.createElement("label",{htmlFor:"studentId2",className:"sr-only"},"Banner ID, User name, or Full Name"),React.createElement(SearchBox,{onSelect:this.doSearch,onReset:this.resetPreview}),this.state.studentFound?React.createElement("span",{className:"glyphicon glyphicon-ok form-control-feedback","aria-hidden":"true"}):null,this.state.studentFound?React.createElement("span",{id:"inputSuccess2Status",className:"sr-only"},"(success)"):null),this.state.studentFound?React.createElement(StudentPreview,{student:this.state.student}):null))))))}}),SearchBox=React.createClass({displayName:"SearchBox",getInitialState:function(){return{dataError:null}},componentDidMount:function(){var searchSuggestions=new Bloodhound({datumTokenizer:function(datum){var nameTokens=Bloodhound.tokenizers.obj.whitespace("name"),studentIdTokens=Bloodhound.tokenizers.obj.whitespace("studentId");Bloodhound.tokenizers.obj.whitespace("email");return nameTokens.concat(studentIdTokens).concat(usernameToekns)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"index.php?module=intern&action=GetSearchSuggestions&searchString=%QUERY",wildcard:"%QUERY"}}),myComponent=this,element=this.refs.typeahead;$(element).typeahead({minLength:3,highlight:!0,hint:!0},{name:"students",display:"studentId",source:searchSuggestions.ttAdapter(),limit:15,templates:{suggestion:function(row){return void 0===row.error?"<p>"+row.name+" &middot; "+row.studentId+"</p>":(myComponent.setState({dataError:row.error}),"<p></p>")}}});var handleSearch=this.props.onSelect;$(element).bind("typeahead:select",function(obj,datum,name){void 0===datum.error&&handleSearch(datum.studentId)});var handleReset=this.props.onReset;$(element).keydown(function(e){return 13==e.keyCode?void e.preventDefault():void(9!=e.keyCode&&handleReset())}),$(element).blur(function(e){handleSearch($(element).typeahead("val"))})},componentWillUnmount:function(){var element=ReactDOM.findDOMNode(this);$(element).typeahead("destroy")},render:function(){var errorNotice=null;return null!==this.state.dataError&&(errorNotice=React.createElement("div",{style:{marginTop:"1em"},className:"alert alert-danger"},React.createElement("p",null,this.state.dataError))),React.createElement("div",null,React.createElement("input",{type:"search",name:"studentId",id:"studentSearch",className:"form-control typeahead input-lg",placeholder:"Banner ID, User name, or Full Name",ref:"typeahead",autoComplete:"off",autofocus:!0}),errorNotice)}}),StudentPreview=React.createClass({displayName:"StudentPreview",render:function(){return React.createElement("div",null,React.createElement("span",{className:"lead"}," ",this.props.student.name),React.createElement("br",null),React.createElement("i",{className:"fa fa-credit-card"})," ",this.props.student.studentId,React.createElement("br",null),React.createElement("i",{className:"fa fa-envelope"})," ",this.props.student.email,React.createElement("br",null),React.createElement("i",{className:"fa fa-graduation-cap"})," ",this.props.student.major)}}),TermBlock=React.createClass({displayName:"TermBlock",getInitialState:function(){return{terms:null,hasError:!1}},componentWillMount:function(){$.ajax({url:"index.php?module=intern&action=GetAvailableTerms",dataType:"json",success:function(data){this.setState({terms:data})}.bind(this),error:function(xhr,status,err){console.error(status,err.toString())}.bind(this)})},setError:function(status){this.setState({hasError:status})},render:function(){var terms=this.state.terms;if(null===terms)return React.createElement("div",null);var fgClasses=classNames({"form-group":!0,"has-error":this.state.hasError});return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-6 col-md-push-3"},React.createElement("div",{className:fgClasses,id:"term"},React.createElement("label",{htmlFor:"term",className:"control-label"},"Term"),React.createElement("br",null),React.createElement("div",{className:"btn-group","data-toggle":"buttons"},Object.keys(terms).map(function(key){return React.createElement("label",{className:"btn btn-default",key:key},React.createElement("input",{type:"radio",name:"term",key:key,value:key}),terms[key])})))))}}),LocationBlock=React.createClass({displayName:"LocationBlock",getInitialState:function(){return{domestic:null,international:null,availableStates:null,availableCountries:null,hasError:!1}},componentDidMount:function(){$.ajax({url:"index.php?module=intern&action=GetAvailableStates",dataType:"json",success:function(data){this.setState({availableStates:data})}.bind(this),error:function(xhr,status,err){console.error(status,err.toString())}.bind(this)}),$.ajax({url:"index.php?module=intern&action=GetAvailableCountries",dataType:"json",success:function(data){this.setState({availableCountries:data})}.bind(this),error:function(xhr,status,err){console.error(status,err.toString())}.bind(this)})},domestic:function(){this.setState({domestic:!0,international:!1})},international:function(){this.setState({domestic:!1,international:!0})},setError:function(status){this.setState({hasError:status})},render:function(){var dropdown,fgClasses=classNames({"form-group":!0,"has-error":this.state.hasError});return dropdown=null===this.state.domestic?"":this.state.domestic?React.createElement(StateDropDown,{key:"states",ref:"state",states:this.state.availableStates}):React.createElement(InternationalDropDown,{key:"countries",ref:"country",countries:this.state.availableCountries}),React.createElement("div",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-6 col-md-push-3"},React.createElement("div",{className:fgClasses,id:"location"},React.createElement("label",{htmlFor:"location",className:"control-label"},"Location")," ",React.createElement("br",null),React.createElement("div",{className:"btn-group","data-toggle":"buttons"},React.createElement("label",{className:"btn btn-default",onClick:this.domestic},React.createElement("input",{type:"radio",name:"location",defaultValue:"domestic"}),"Domestic"),React.createElement("label",{className:"btn btn-default",onClick:this.international},React.createElement("input",{type:"radio",name:"location",defaultValue:"international"}),"International"))))),React.createElement(ReactCSSTransitionGroup,{transitionName:"example",transitionLeave:!1,transitionEnterTimeout:500},dropdown))}}),Department=React.createClass({displayName:"Department",getInitialState:function(){return{departments:null,hasError:!1}},setError:function(status){this.setState({hasError:status})},componentWillMount:function(){$.ajax({url:"index.php?module=intern&action=GetDepartments",dataType:"json",success:function(data){this.setState({departments:data})}.bind(this),error:function(xhr,status,err){console.error(status,err.toString())}.bind(this)})},render:function(){var departments=this.state.departments;if(null===departments)return React.createElement("div",null);var fgClasses=classNames({"form-group":!0,"has-error":this.state.hasError});return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-4 col-md-push-3"},React.createElement("div",{className:fgClasses,id:"department"},React.createElement("label",{htmlFor:"department2",className:"control-label"},"Department"),React.createElement("select",{id:"department2",name:"department",className:"form-control",defaultValue:"-1"},Object.keys(departments).map(function(key){return React.createElement("option",{key:key,value:key},departments[key])})))))}}),HostAgency=React.createClass({displayName:"HostAgency",getInitialState:function(){return{hasError:!1}},setError:function(status){this.setState({hasError:status})},render:function(){var fgClasses=classNames({"form-group":!0,"has-error":this.state.hasError});return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-4 col-md-push-3"},React.createElement("div",{className:fgClasses,id:"agency"},React.createElement("label",{htmlFor:"agency2",className:"control-label"},"Host Agency"),React.createElement("input",{type:"text",id:"agency2",name:"agency",className:"form-control",placeholder:"Acme, Inc."}))))}}),CreateInternshipButton=React.createClass({displayName:"CreateInternshipButton",render:function(){var button=null;return button=this.props.submitted?React.createElement("button",{type:"submit",className:"btn btn-lg btn-primary pull-right",id:"create-btn",disabled:!0},React.createElement("i",{className:"fa fa-spinner fa-spin"})," Saving..."):React.createElement("button",{type:"submit",className:"btn btn-lg btn-primary pull-right",id:"create-btn",onClick:this.handleClick},"Create Internship"),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-6 col-md-push-3"},button))}}),ErrorMessagesBlock=React.createClass({displayName:"ErrorMessagesBlock",render:function(){if(null===this.props.errors)return"";var errors=this.props.errors.map(function(message,i){return React.createElement("li",{key:i},message)});return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 col-md-6 col-md-push-3"},React.createElement("div",{className:"alert alert-danger",role:"alert"},React.createElement("p",null,React.createElement("i",{className:"fa fa-exclamation-circle fa-2x"})," Please select values for the following fields: "),React.createElement("ul",null,errors))))}}),CreateInternshipInterface=React.createClass({displayName:"CreateInternshipInterface",getInitialState:function(){return{submitted:!1,errorMessages:null}},handleSubmit:function(e){e.preventDefault();var thisComponent=this,formElement=e.target;this.setState({submitted:!0,errorMessages:null},function(){return this.validate(formElement,thisComponent)?void formElement.submit():void setTimeout(function(){thisComponent.setState({submitted:!1})},1e3)})},validate:function(form,thisComponent){var valid=!0,errors=[];return""!==form.elements.studentId.value&&thisComponent.refs.studentSearch.studentFound()?thisComponent.refs.studentSearch.setError(!1):(thisComponent.refs.studentSearch.setError(!0),errors.push("Student ID"),valid=!1),""===form.elements.term.value?(thisComponent.refs.termBlock.setError(!0),errors.push("Term"),valid=!1):thisComponent.refs.termBlock.setError(!1),""===form.elements.location.value?(thisComponent.refs.locationBlock.setError(!0),errors.push("Location"),valid=!1):thisComponent.refs.locationBlock.setError(!1),"domestic"===form.elements.location.value?"-1"===form.elements.state.value?(thisComponent.refs.locationBlock.refs.state.setError(!0),errors.push("State"),valid=!1):thisComponent.refs.locationBlock.refs.state.setError(!1):"international"===form.elements.location.value&&("-1"===form.elements.country.value?(thisComponent.refs.locationBlock.refs.country.setError(!0),errors.push("Country"),valid=!1):thisComponent.refs.locationBlock.refs.country.setError(!1)),"_-1"===form.elements.department.value?(thisComponent.refs.department.setError(!0),valid=!1,errors.push("Department")):thisComponent.refs.department.setError(!1),""===form.elements.agency.value?(thisComponent.refs.hostAgency.setError(!0),valid=!1,errors.push("Host Agency")):thisComponent.refs.hostAgency.setError(!1),0!=errors.length&&thisComponent.setErrorMessages(errors),valid},setErrorMessages:function(messages){this.setState({errorMessages:messages})},render:function(){var errors;return errors=null==this.state.errorMessages?"":React.createElement(ErrorMessagesBlock,{key:"errorSet",errors:this.state.errorMessages}),React.createElement("form",{role:"form",id:"newInternshipForm",className:"form-protected",action:"index.php",method:"post",onSubmit:this.handleSubmit},React.createElement("input",{type:"hidden",name:"module",value:"intern"}),React.createElement("input",{type:"hidden",name:"action",value:"AddInternship"}),React.createElement(ReactCSSTransitionGroup,{transitionName:"example",transitionEnterTimeout:500,transitionLeaveTimeout:500},errors),React.createElement(StudentSearch,{ref:"studentSearch"}),React.createElement(TermBlock,{ref:"termBlock"}),React.createElement(LocationBlock,{ref:"locationBlock"}),React.createElement(Department,{ref:"department"}),React.createElement(HostAgency,{ref:"hostAgency"}),React.createElement(CreateInternshipButton,{submitted:this.state.submitted}))}});ReactDOM.render(React.createElement(CreateInternshipInterface,null),document.getElementById("createInternshipInterface"));